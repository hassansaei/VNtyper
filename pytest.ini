[pytest]
# Limit test discovery to tests/ directory only (faster collection)
testpaths = tests

markers =
    integration: marks tests as integration tests
    unit: marks tests as unit tests

# Exclude large data directories from test collection (major performance boost)
norecursedirs = download reference references out tmp test testing docker/test_output .git .pytest_cache __pycache__ *.egg-info build dist .tox .nox htmlcov

# ============================================================================
# Live Logging Configuration (shows logs in real-time during test execution)
# ============================================================================
# Enable live logging to CLI (shows logs immediately, not just on failure)
log_cli = true

# Set live logging level (INFO shows progress, DEBUG for more detail)
log_cli_level = INFO

# Format for live logs (includes timestamp and level for better tracking)
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s

# Date format for live logs
log_cli_date_format = %H:%M:%S

# ============================================================================
# File Logging Configuration (for persistent logs)
# ============================================================================
# Also log to file for later analysis
log_file = tests/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] [%(filename)s:%(lineno)d] %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# ============================================================================
# Captured Log Configuration (for assertions and test validation)
# ============================================================================
# Log level for captured logs (available via caplog fixture)
log_level = DEBUG

# ============================================================================
# Test Timeout Configuration
# ============================================================================
# Timeout for integration tests (10 minutes) - prevents stuck tests
# Requires: pip install pytest-timeout
# timeout = 600
# timeout_method = thread

# ============================================================================
# Test Output Configuration
# ============================================================================
# Show extra test summary info
console_output_style = progress

# Show durations of slowest tests
addopts = --durations=10 --durations-min=1.0
